# Bee Project: 말벌 탐지 모델

**Bee Project**에 오신 것을 환영합니다! 이 프로젝트는 벌통 환경에서 말벌을 감지하기 위한 강력한 머신 러닝 모델을 개발하는 데 중점을 두고 있습니다. 고급 오디오 처리 및 ML 기술을 통해 말벌 위협을 조기에 감지하여 벌 군락의 안전을 보장하는 것이 목표입니다.

## 프로젝트 개요

이 프로젝트는 말벌 소리 녹음에서 추출한 **MFCC(멜 주파수 켑스트럼 계수)** 특징과 **저역 통과 필터링(LPF)**, **PCA(주성분 분석)**를 사용한 특징 엔지니어링을 활용합니다. 주요 목표는 실시간 말벌 탐지를 위한 신뢰성 있는 데이터 기반 모델을 만드는 것입니다.

## 주요 기능

- **데이터 전처리**: **Librosa**를 사용하여 오디오 파일을 전처리하고, **저역 통과 필터링**을 통해 잡음을 제거하며 **MFCC**를 통해 의미 있는 특징을 추출합니다.
- **특징 엔지니어링**: **PCA**를 적용하여 MFCC 특징의 차원을 줄이고 분류에 가장 유용한 요소를 유지합니다.
- **모델 구축**: Feature 값에 집중하기 위해 **로지스틱 회귀(Logistic Regression)**를 사용하여 기본적인 분류 모델을 구현하였으며, 반지도 학습 기법인 **의사 라벨링(pseudo-labeling)**을 활용하여 모델의 성능을 개선하고, 실제 환경의 잡음 속에서도 과적합 없이 동작하도록 합니다.
- **평가**: 모델 평가에는 성능 지표 평가와 각 MFCC의 확률 시각화가 포함되며, 특히 말벌 활동과 강한 상관관계를 보이는 **MFCC4**에 중점을 둡니다.

## 사용된 기술

| 기술                     | 설명                          |
| ---------------------- | --------------------------- |
| **Python**             | 모델 구축 및 학습을 위한 주요 프로그래밍 언어  |
| **Librosa**            | 오디오 특징 분석 및 추출을 위한 라이브러리    |
| **Scikit-Learn**       | PCA 적용 및 머신 러닝 모델 구현에 사용    |
| **Matplotlib**         | 특징 분포, 모델 성능 및 인사이트 시각화     |

## 동기와 목표

**Bee Project**는 말벌 위협을 조기에 감지하여 벌 군락 보호에 기여하고, 벌들에게 지속 가능한 환경을 보장하는 것을 목표로 합니다. 또한, 이 프로젝트는 잡음이 많은 환경에서의 **반지도 학습** 탐구를 통해 모델의 강건성과 실용적인 배포 가능성을 높이는 것을 목표로 합니다.

## 작동 원리

1. **데이터 수집**: 말벌 소리 녹음을 통제된 환경과 자연 환경에서 수집했습니다.
2. **전처리**: **Librosa**를 사용하여 오디오 신호를 처리하고, 저역 통과 필터링을 적용하여 배경 잡음을 제거하고 말벌 활동과 관련된 특정 주파수를 분리했습니다.
3. **특징 추출**: **MFCC** 특징을 추출한 후 **PCA**를 사용하여 가장 중요한 요소를 유지하며 차원을 축소했습니다.
4. **모델 학습**: **로지스틱 회귀**와 **의사 라벨링**을 활용하여 레이블이 없는 데이터를 처리하고 탐지 정확도를 향상시켰습니다.
5. **배포 고려사항**: 최종 모델은 벌통 근처의 엣지 장치에 배포되어 실시간 탐지 및 경고를 제공하도록 설계되었습니다.

## 결과 및 인사이트

- **MFCC4 분석**: **MFCC4** 계수가 말벌의 주파수 신호와 밀접하게 일치하여 탐지를 위한 강력한 지표임을 확인했습니다.
- **반지도 학습**: 레이블이 없는 데이터를 의사 라벨링으로 포함하여 잡음이 많은 환경에서 과적합을 줄이고 전체적인 모델 정확도를 향상시켰습니다.

## 향후 작업

- **엣지 장치 통합**: 벌통 환경에서 실시간 모니터링을 위한 **IoT** 장치에 모델을 통합할 계획입니다.
- **데이터셋 확장**: 다양한 말벌 종과 여러 환경 조건을 포함하도록 데이터셋을 확대할 예정입니다.
- **잡음 감소 개선**: 다양한 환경 조건에서 정확도를 높이기 위해 잡음 필터링 과정을 추가로 개선할 계획입니다.

---

## 실행 방법

1. **필수 라이브러리 설치**:
   ```bash
   pip install -r requirements.txt
   ```
2. **데이터 준비**: 데이터셋을 `data/` 디렉터리에 저장합니다.
3. **모델 학습**: 아래의 명령어를 통해 모델을 학습시킵니다.
   ```bash
   python train_model.py
   ```
4. **모델 평가**: 학습된 모델을 평가하려면 다음 명령어를 사용하세요.
   ```bash
   python evaluate_model.py
   ```

## 프로젝트 구조

```
Bee_Project/
├── data/                # 데이터셋 저장 디렉터리
├── models/              # 학습된 모델 저장 디렉터리
├── notebooks/           # 실험용 소스코드 (0) ~ (14)
├── src/                 # 주요 소스 코드
│   ├── preprocessing.py # 데이터 전처리 코드
│   ├── feature_extract.py # 특징 추출 코드
│   ├── train_model.py   # 모델 학습 코드
│   └── evaluate_model.py # 모델 평가 코드
├── requirements.txt     # 필수 라이브러리 목록
└── README.md            # 프로젝트 설명 파일
```
